<!DOCTYPE html>
<html>
  <head>
    <title>Khan Academy Challenge Framework</title>
    <link rel="stylesheet" type="text/css" href="scss/output.css">
    <style type="text/css" media="screen">
    #editor {
        position: relative;
        height: 300px;
        width: 100%;
/*        top: 0;
        right: 0;
        bottom: 0;
        left: 0;*/
    }
  </style>
  </head>
  <body>
    <div class="title">khan academy challenge</div>
    <div>We'd like to be able to have a few testing APIs to work with, namely:</div>

    <ul>

      <li>A whitelist of specific functionality. For example, the ability to say "This program MUST use a 'for loop' and a 'variable declaration'."</li>

      <li>A blacklist of specific functionality. For example, the ability to say "This program MUST NOT use a 'while loop' or an 'if statement'."</li>


      <li>Determine the rough structure of the program. For example, "There should be a 'for loop' and inside of it there should be an 'if statement'."</li>

    </ul>

    <ul>
      <li class="for">Great job!  We input a for loop!</li>
      <li class="var">Good going!  We have a variable declaration!</li>
    </ul>
    <div id="editor">function foo(items) {
  for (var i = 0; i < 5; i++) {
    console.log(i);
  }
}</div>
    <div class="output"></div>
    <script src="https://code.jquery.com/jquery-2.2.1.js" integrity="sha256-eNcUzO3jsv0XlJLveFEkbB8bA7/CroNpNVk3XpmnwHc=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="src/ace/src-min-noconflict/ace.js"></script>
    <script type="text/javascript" src="node_modules/acorn/dist/acorn.js" charset="UTF-8"></script>
    <script type="text/javascript" src="node_modules/acorn/dist/acorn_loose.js" charset="UTF-8"></script>
    <script type="text/javascript" src="js/app.js"></script>
    <script>
      //editor
      var editor = ace.edit("editor");
      editor.setTheme("ace/theme/monokai");
      editor.getSession().setMode("ace/mode/javascript");

      // console.log(editor.getValue()); // returns a string value of editor
      //to make this appear from the document.load()
      $(document).ready(function(){
        testingForLoop();
        testingVarDec();
      });

      //on each key entered...
      $('#editor').keyup(function(event) {

          //whitelist functionality
          testingForLoop();
          testingVarDec();
          //blacklist functionality

          //determine rough structure of program
      });

      function getEditorCode() {
        //get input in text editor
        var textEditor = editor.getValue();
        //split every word up in text editor
        var splitWords = textEditor.split(' ');
        return splitWords;
      }


      // modular function to test for loops
      function testingForLoop() {
        return testing(getEditorCode(), 'for');
      }

      function testingVarDec() {
        return testing(getEditorCode(), 'var');
      }

      //modular function for testing for any code in our text editor
      function testing(editorCode, codeSearchFor) {
        var notification = document.getElementsByClassName(codeSearchFor);


        //go through splitWords and if we find 'for', then show notification
        if (editorCode.indexOf(codeSearchFor) !== -1) {
          if (notification[0].style.display = 'none') {
            notification[0].style.display = 'block';
          }
        //go through splitWords and if we DON'T find 'for', then hide the notification
        } else {
          if (notification[0].style.display = 'block') {
            notification[0].style.display = 'none';
          }
        }
      }
    </script>
  </body>
</html>
